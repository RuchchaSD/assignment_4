1. make a global object for attack detector 
2. queue up all  the events in to a buffer with instrument function
3. run the rules logic in a different thread
4. use with other context as well (power values, etc ...)